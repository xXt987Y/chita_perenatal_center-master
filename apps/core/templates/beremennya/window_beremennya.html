<div class="window_beremennya">
    <div class="tab_beremennya">
        <ul>
            <li>Основные данные</li>
            <li>Анкеты</li>
            <li>Направление</li>
            <li>Консультация</li>
            <li>Исход</li>
        </ul>
        <div class="tab_osnovnie_danie">
            {% include 'beremennya/beremennaya_tabs/osnovnie_dannie.html' %}
        </div>
        <div>
            {% include 'beremennya/beremennaya_tabs/anketi/anketi.html' %}
        </div>
        <div>
            {% include 'beremennya/beremennaya_tabs/napravlenie/napravleniya.html' %}
        </div>
        <div>
            {% include 'beremennya/beremennaya_tabs/konsultaciya.html' %}
        </div>
        <div>
            {% include 'beremennya/beremennaya_tabs/ishod.html' %}
        </div>
    </div>
</div>


<style>
</style>


<script>


    class WindowBeremennya {
        constructor($window_beremennya, $tab, $btn_open_window_beremennya) {
            let self = this;
            this.$window = $($window_beremennya);
            this.$tab = $tab;
            this.$btn_open_window = $btn_open_window_beremennya;
            this.$window.jqxWindow({
                position: {x: '15%', y: '10%'},
                maxHeight: 1000,
                maxWidth: 2200,
                minHeight: 400,
                minWidth: 700,
                theme: 'arctic',
                height: 500,
                width: 1200,
                title: 'Беременная',
                autoOpen: false,
                resizable: true,
                draggable: true,
                initContent: function () {
                    $(self.$tab).jqxTabs({
                        height: '100%',
                        width: '100%',
                        theme: 'arctic',
                    });
                }
            });

            this.on_close();
        }

        open(id = 0) {
            let self = this;
            if (id) {
                fetch(`/api/beremennaya/${id}`).then(function (response) {
                    if (response.ok) {
                        response.json().then(function (data) {
                            self.$window.find('.tab_osnovnie_danie .stepen_riska').jqxComboBox('selectItem', data['stepen_riska']);
                            {#self.$window.find('.tab_osnovnie_danie .data_vzyatiya').jqxDateTimeInput(data['data_vzyatiya']);#}
                            self.$window.find('.tab_osnovnie_danie .vrach').jqxComboBox('selectItem', data['vrach']);
                            self.$window.find('.tab_osnovnie_danie input.fio').val(data['fio']);
                            {#self.$window.find('.tab_osnovnie_danie .data_rojdeniya').jqxDateTimeInput(value['jqxDateTimeInput']);#}
                            self.$window.find('.tab_osnovnie_danie input.vozrast').val(data['vozrast']);
                            self.$window.find('.tab_osnovnie_danie .mesto_postoyannogo_projivaniya').jqxComboBox('selectItem', data['mesto_postoyannogo_projivaniya']);
                            self.$window.find('.tab_osnovnie_danie input.nomer_telefona').val(data['nomer_telefona']);
                            self.$window.find('.tab_osnovnie_danie input.nomer_oms').val(data['nomer_oms']);

                            self.$window.find('.tab_osnovnie_danie .semeynoe_polojenie').jqxComboBox('selectItem', data['semeynoe_polojenie']);
                            self.$window.find('.tab_osnovnie_danie .vrednie_privichki_kurenie').jqxCheckBox({checked: data['vrednie_privichki_kurenie']});
                            self.$window.find('.tab_osnovnie_danie .vrednie_privichki_alco').jqxCheckBox({checked: data['vrednie_privichki_alco']});
                            self.$window.find('.tab_osnovnie_danie .vrednie_privichki_narko').jqxCheckBox({checked: data['vrednie_privichki_narko']});
                            self.$window.find('.tab_osnovnie_danie .vrednie_privichki_toxi').jqxCheckBox({checked: data['vrednie_privichki_toxi']});

                            self.$window.jqxWindow('open');
                        }).catch(function () {
                            alert('Не могу получить JSON ');
                        })

                    } else {
                        alert('Не могу получить данные');
                    }
                })

            }

        }

        on_close() {
            let self = this;
            this.$window.on('close', function () {
                self.$btn_open_window.jqxToggleButton('toggled', false);
            });
        }

    }


    let $window_beremennya = $('.window_beremennya');
    let $tab_beremennya = $('.tab_beremennya');
    let obj_window_beremennya = new WindowBeremennya($window_beremennya, $tab_beremennya, $btn_open_window_beremennya);
</script>